
Pasted image 20230923102329.png
https://tryhackme.com/room/agentt

TASK: find the flag

I started nmap to scan open ports and running services:
$ nmap -sV -sC -v 10.10.237.128
Pasted image 20230923103924.png

There's only one HTTP port open.
Let's open our web browser and see what's running on the webserver:

Pasted image 20230923102959.png

I used gobuster to scan directories and files on http://10.10.237.128/ website to identify hidden resources or potential security vulnerabilities, but nothing has been found:

Pasted image 20230923112133.png

However, from the nmap scan, we know that the website is running a PHP cli server 5.5 or later (PHP 8.1.0-dev), so we can check its vulnerability

Pasted image 20230923103655.png

 I used searchsploit  to see if thereâ€™s any known exploits for PHP cli server 5.5 or PHP 8.1.0-dev:
Pasted image 20230923105759.png

so I found:
HP 8.1.0-dev - 'User-Agentt' Remote Code Execution php/webapps/49933.py

I've copied this exploit:
$ searchsploit -m 49933
Pasted image 20230923105952.png

Running the exploit:

$ sudo python3 49933.py
Pasted image 20230923110658.png

Whoami query shows that I'm a root:
Pasted image 20230923110811.png

I've used a find command to retrieve a flag:
Pasted image 20230923111135.png

I've displayed the content of the "flag.txt":

Pasted image 20230923111338.png
